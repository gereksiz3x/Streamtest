name: Collect Streams - DEBUG MODE

on:
  workflow_dispatch:  # Sadece manuel çalıştır

jobs:
  collect:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
      
    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: pip install requests
      
    - name: Run Debug Collector
      run: |
        echo "=== STARTING ULTIMATE DEBUG COLLECTOR ==="
        python collector.py
        echo "=== ALL FILES ==="
        ls -la
        echo "=== FILE CONTENTS ==="
        for file in *.m3u *.txt *.html; do
          if [ -f "$file" ]; then
            echo "--- $file (first 10 lines) ---"
            head -10 "$file" 2>/dev/null || echo "Cannot read"
            echo
          fi
        done
        
    - name: Upload Debug Files
      uses: actions/upload-artifact@v4
      with:
        name: ultimate-debug
        path: |
          *.m3u
          *.txt
          *.html
        retention-days: 7
